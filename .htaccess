RewriteEngine On
RewriteBase /

Options -Indexes

# Block direct access to private folders/files in project root
RewriteRule ^(app|vendor|bin)/ - [F,L]
RewriteRule ^\.env$ - [F,L]
RewriteRule ^composer\.(json|lock)$ - [F,L]

# If URL already begins with /public, do not rewrite it again
RewriteRule ^public/ - [L]

# Serve existing files/dirs from /public (assets)
RewriteCond %{DOCUMENT_ROOT}/public%{REQUEST_URI} -f [OR]
RewriteCond %{DOCUMENT_ROOT}/public%{REQUEST_URI} -d
RewriteRule ^(.+)$ public/$1 [L]

# Otherwise route everything to the front controller
RewriteRule ^ public/index.php [L]
