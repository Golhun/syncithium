RewriteEngine On
Options -Indexes

# Block access to private folders/files if they exist under public_html
RewriteRule ^(app|vendor|bin)/ - [F,L]
RewriteRule ^\.env - [F,L]
RewriteRule ^composer\.(json|lock)$ - [F,L]

# Serve existing files or directories directly
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# If the file exists inside /public, serve it from there
RewriteCond %{DOCUMENT_ROOT}/public%{REQUEST_URI} -f [OR]
RewriteCond %{DOCUMENT_ROOT}/public%{REQUEST_URI} -d
RewriteRule ^(.*)$ public/$1 [L]

# Otherwise route everything to the front controller
RewriteRule ^ public/index.php [L]
